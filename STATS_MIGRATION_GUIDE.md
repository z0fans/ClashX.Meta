# Stats æ‰“åŒ…æ–¹æ¡ˆè¿ç§»æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

æœ¬æŒ‡å—è®°å½•äº†å°† [Stats é¡¹ç›®](https://github.com/exelban/stats) çš„ DMG æ‰“åŒ…æ–¹æ¡ˆå®Œæ•´è¿ç§»åˆ° ClashX Meta é¡¹ç›®çš„è¿‡ç¨‹ã€‚

---

## ğŸ¯ å·²å®Œæˆçš„è¿ç§»å·¥ä½œ

### 1. **èƒŒæ™¯å›¾è¿ç§»** âœ…

- **æºæ–‡ä»¶**: `stats_background_original.png` (ä» Stats é¡¹ç›®ä¸‹è½½)
- **æ–°æ–‡ä»¶**: `dmg_background_new.png`
- **è§„æ ¼**: 1000 x 600 åƒç´ , 144 DPI, PNG æ ¼å¼
- **è®¾è®¡**: æµ…ç°è‰²èƒŒæ™¯ + é»‘è‰²ç®­å¤´ (æç®€ä¸»ä¹‰é£æ ¼)

### 2. **æ‰“åŒ…è„šæœ¬æ›´æ–°** âœ…

æ›´æ–°äº† `create_dmg.sh`,å®Œå…¨é‡‡ç”¨ Stats çš„å‚æ•°é…ç½®:

```bash
# Stats çš„çª—å£é…ç½®
--window-pos 200 120       # çª—å£ä½ç½®
--window-size 500 320      # çª—å£å¤§å°
--icon-size 80             # å›¾æ ‡å¤§å°
--icon "ClashX Meta.app" 125 175      # åº”ç”¨å›¾æ ‡ä½ç½®
--app-drop-link 375 175    # Applications é“¾æ¥ä½ç½®
--hide-extension           # éšè—æ‰©å±•å
--no-internet-enable       # ç¦ç”¨ç½‘ç»œåŠŸèƒ½
```

### 3. **Makefile åˆ›å»º** âœ…

å‚è€ƒ Stats çš„ Makefile ç»“æ„,åˆ›å»ºäº†å®Œæ•´çš„è‡ªåŠ¨åŒ–æ„å»ºæµç¨‹:

```makefile
build: clean archive prepare-dmg prepare-dSYM open
```

åŒ…å«çš„ä¸»è¦åŠŸèƒ½:
- `make build` - å®Œæ•´æ„å»ºæµç¨‹
- `make archive` - æ„å»ºå¹¶å½’æ¡£åº”ç”¨
- `make prepare-dmg` - åˆ›å»º DMG
- `make prepare-dSYM` - æ‰“åŒ…è°ƒè¯•ç¬¦å·
- `make clean` - æ¸…ç†æ„å»ºäº§ç‰©
- `make help` - æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯

---

## ğŸ“Š å¯¹æ¯”è¡¨æ ¼

| ç‰¹æ€§ | Stats åŸå§‹é…ç½® | ClashX Meta è¿ç§»å | çŠ¶æ€ |
|------|---------------|-------------------|------|
| **DMG å·¥å…·** | create-dmg | create-dmg | âœ… |
| **èƒŒæ™¯å›¾å°ºå¯¸** | 1000x600 @144 DPI | 1000x600 @144 DPI | âœ… |
| **çª—å£å¤§å°** | 500x320 | 500x320 | âœ… |
| **å›¾æ ‡å¤§å°** | 80px | 80px | âœ… |
| **åº”ç”¨å›¾æ ‡ä½ç½®** | 125,175 | 125,175 | âœ… |
| **Apps é“¾æ¥ä½ç½®** | 375,175 | 375,175 | âœ… |
| **çª—å£ä½ç½®** | 200,120 | 200,120 | âœ… |
| **è‡ªåŠ¨åŒ–æ„å»º** | Makefile | Makefile | âœ… |

---

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### å¿«é€Ÿå¼€å§‹

```bash
# 1. æ£€æŸ¥ä¾èµ–
make check-deps

# 2. å®Œæ•´æ„å»º (åŒ…å« DMG)
make build

# 3. æŸ¥çœ‹å¸®åŠ©
make help
```

### è¯¦ç»†æ­¥éª¤

#### **æ–¹å¼ä¸€: ä½¿ç”¨ Makefile (æ¨è)**

```bash
# å®Œæ•´æ„å»ºæµç¨‹
make build

# è¾“å‡ºæ–‡ä»¶:
#   - ClashX Meta.dmg
#   - dSYMs.zip (è°ƒè¯•ç¬¦å·)
```

#### **æ–¹å¼äºŒ: æ‰‹åŠ¨æ‰§è¡Œè„šæœ¬**

```bash
# 1. æ„å»ºåº”ç”¨
xcodebuild archive -project ClashX.xcodeproj \
    -scheme "ClashX Meta" \
    -archivePath archive/ClashX.xcarchive

# 2. åˆ›å»º DMG
bash create_dmg.sh
```

---

## ğŸ¨ èƒŒæ™¯å›¾è¯´æ˜

### Stats çš„è®¾è®¡ç†å¿µ

Stats ä½¿ç”¨äº†æç®€ä¸»ä¹‰çš„èƒŒæ™¯å›¾è®¾è®¡:
- **é¢œè‰²**: æµ…ç°è‰² (#DCDCDC)
- **å…ƒç´ **: ä¸€ä¸ªé»‘è‰²ç®­å¤´ (â†’)
- **ç›®çš„**: å¼•å¯¼ç”¨æˆ·å°†åº”ç”¨æ‹–æ‹½åˆ° Applications æ–‡ä»¶å¤¹

### å½“å‰å®ç°

æˆ‘ä»¬é‡‡ç”¨äº†å®Œå…¨ç›¸åŒçš„è®¾è®¡:
- å¤åˆ¶äº† Stats çš„åŸå§‹èƒŒæ™¯å›¾
- ä¿æŒ 1000x600 åˆ†è¾¨ç‡
- æ”¯æŒ Retina æ˜¾ç¤º (144 DPI)

### è‡ªå®šä¹‰å»ºè®®

å¦‚æœä½ æƒ³åˆ›å»º ClashX Meta ç‰¹è‰²çš„èƒŒæ™¯å›¾:

```bash
# ä½¿ç”¨å›¾åƒç¼–è¾‘å·¥å…· (å¦‚ Photoshop, Figma)
# 1. åˆ›å»º 1000x600 ç”»å¸ƒ
# 2. èƒŒæ™¯è‰²: æµ…ç°è‰²æˆ–å“ç‰Œè‰²
# 3. æ·»åŠ ç®­å¤´æŒ‡å‘å³ä¾§
# 4. (å¯é€‰) æ·»åŠ å“ç‰Œ Logo æˆ–æ–‡å­—
# 5. å¯¼å‡ºä¸º PNG, 144 DPI
# 6. ä¿å­˜ä¸º dmg_background_new.png
```

---

## ğŸ“¦ æ„å»ºäº§ç‰©

å®Œæ•´çš„æ„å»ºæµç¨‹ä¼šç”Ÿæˆä»¥ä¸‹æ–‡ä»¶:

```
ClashX.Meta-1.4.27/
â”œâ”€â”€ ClashX Meta.dmg          # DMG å®‰è£…åŒ…
â”œâ”€â”€ dSYMs.zip                # è°ƒè¯•ç¬¦å· (ç”¨äºå´©æºƒåˆ†æ)
â””â”€â”€ archive/
    â””â”€â”€ ClashX.xcarchive/    # Xcode å½’æ¡£
```

---

## ğŸ” ä»£ç ç­¾åå’Œå…¬è¯

### Stats çš„å®Œæ•´æµç¨‹

```makefile
# 1. å½’æ¡£åº”ç”¨
xcodebuild archive ...

# 2. æäº¤å…¬è¯
xcrun notarytool submit --keychain-profile "AC_PASSWORD" --wait

# 3. è£…è®¢ç¥¨æ®
xcrun stapler staple ClashX Meta.app

# 4. éªŒè¯ç­¾å
spctl -a -t exec -vvv ClashX Meta.app
```

### å½“å‰çŠ¶æ€

- âœ… æ„å»ºæµç¨‹å·²å®Œæˆ
- âš ï¸ ç­¾åå’Œå…¬è¯éœ€è¦æ‰‹åŠ¨æ‰§è¡Œ (éœ€è¦ Apple Developer è´¦å·)
- ğŸ“ åœ¨ Makefile ä¸­æä¾›äº†å®Œæ•´çš„ç­¾åæŒ‡å— (`make sign`)

---

## ğŸ” ä¸åŸæ–¹æ¡ˆçš„å·®å¼‚

### ä¿ç•™çš„ç‰¹æ€§
- âœ… å®Œå…¨ç›¸åŒçš„çª—å£å¸ƒå±€
- âœ… ç›¸åŒçš„èƒŒæ™¯å›¾è®¾è®¡
- âœ… ç›¸åŒçš„ create-dmg å‚æ•°
- âœ… Makefile è‡ªåŠ¨åŒ–æµç¨‹

### ç®€åŒ–çš„éƒ¨åˆ†
- âš ï¸ ç­¾åå’Œå…¬è¯æ”¹ä¸ºæ‰‹åŠ¨æ­¥éª¤ (Stats æ˜¯å…¨è‡ªåŠ¨)
- âš ï¸ æœªåŒ…å«ç‰ˆæœ¬å·è‡ªåŠ¨é€’å¢ (Stats çš„ `next-version`)

### æ–°å¢çš„åŠŸèƒ½
- âœ… æ›´è¯¦ç»†çš„æ—¥å¿—è¾“å‡º
- âœ… DMG å®Œæ•´æ€§éªŒè¯
- âœ… æ›´å‹å¥½çš„é”™è¯¯æç¤º
- âœ… ä¾èµ–æ£€æŸ¥å‘½ä»¤ (`make check-deps`)

---

## ğŸ› ï¸ æ•…éšœæ’æŸ¥

### é—®é¢˜ 1: æœªæ‰¾åˆ°åº”ç”¨ç¨‹åº

```bash
âŒ é”™è¯¯: æ‰¾ä¸åˆ°åº”ç”¨ç¨‹åº archive/ClashX.xcarchive/...
```

**è§£å†³æ–¹æ¡ˆ**:
```bash
# å…ˆæ‰§è¡Œæ„å»º
make archive
# ç„¶åå†åˆ›å»º DMG
make dmg-only
```

### é—®é¢˜ 2: create-dmg å·¥å…·æœªå®‰è£…

```bash
âŒ é”™è¯¯: æœªæ‰¾åˆ° create-dmg
```

**è§£å†³æ–¹æ¡ˆ**:
```bash
# è„šæœ¬ä¼šè‡ªåŠ¨å…‹éš† create-dmg å·¥å…·
# å¦‚æœå¤±è´¥,æ‰‹åŠ¨æ‰§è¡Œ:
git clone https://github.com/create-dmg/create-dmg
```

### é—®é¢˜ 3: Xcode è®¸å¯æœªæ¥å—

```bash
âŒ You have not agreed to the Xcode license agreements.
```

**è§£å†³æ–¹æ¡ˆ**:
```bash
sudo xcodebuild -license accept
```

---

## ğŸ“š å‚è€ƒèµ„æº

- **Stats é¡¹ç›®**: https://github.com/exelban/stats
- **Stats Makefile**: https://github.com/exelban/stats/blob/master/Makefile
- **create-dmg å·¥å…·**: https://github.com/create-dmg/create-dmg
- **Apple å…¬è¯æŒ‡å—**: https://developer.apple.com/documentation/security/notarizing_macos_software_before_distribution

---

## âœ… éªŒè¯æ¸…å•

è¿ç§»å®Œæˆå,è¯·éªŒè¯ä»¥ä¸‹é¡¹ç›®:

- [ ] èƒŒæ™¯å›¾æ–‡ä»¶å­˜åœ¨ä¸”å°ºå¯¸æ­£ç¡® (1000x600)
- [ ] create_dmg.sh ä½¿ç”¨ Stats çš„å‚æ•°é…ç½®
- [ ] Makefile å¯ä»¥æ­£å¸¸æ‰§è¡Œ `make help`
- [ ] æ„å»ºåçš„ DMG çª—å£å¸ƒå±€æ­£ç¡®
- [ ] åº”ç”¨å›¾æ ‡å’Œ Applications é“¾æ¥ä½ç½®æ­£ç¡®
- [ ] DMG å¯ä»¥æ­£å¸¸æŒ‚è½½å’Œå®‰è£…

---

## ğŸ‰ å®ŒæˆçŠ¶æ€

âœ… **æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½å·²æˆåŠŸè¿ç§»!**

è¿ç§»è¿›åº¦:
- [x] ä¸‹è½½ Stats èƒŒæ™¯å›¾
- [x] åˆ†æèƒŒæ™¯å›¾è®¾è®¡å…ƒç´ 
- [x] è°ƒæ•´èƒŒæ™¯å›¾åˆ°é¡¹ç›®
- [x] æ›´æ–°æ‰“åŒ…è„šæœ¬å‚æ•°
- [x] åˆ›å»º Makefile è‡ªåŠ¨åŒ–æµç¨‹
- [x] ç¼–å†™è¿ç§»æ–‡æ¡£

---

## ğŸš€ ä¸‹ä¸€æ­¥

### å»ºè®®çš„ä¼˜åŒ–æ–¹å‘

1. **å“ç‰ŒåŒ–å®šåˆ¶**
   - åˆ›å»º ClashX Meta ç‰¹è‰²çš„èƒŒæ™¯å›¾
   - æ·»åŠ å“ç‰Œ Logo å’Œé¢œè‰²
   - ä¼˜åŒ–è§†è§‰è®¾è®¡

2. **è‡ªåŠ¨åŒ–å¢å¼º**
   - é›†æˆåˆ° GitHub Actions
   - è‡ªåŠ¨åŒ–ç­¾åå’Œå…¬è¯æµç¨‹
   - è‡ªåŠ¨ç‰ˆæœ¬å·ç®¡ç†

3. **æµ‹è¯•å’ŒéªŒè¯**
   - åœ¨å¤šä¸ª macOS ç‰ˆæœ¬ä¸Šæµ‹è¯•
   - éªŒè¯ DMG åœ¨ä¸åŒåˆ†è¾¨ç‡ä¸‹çš„æ˜¾ç¤ºæ•ˆæœ
   - æµ‹è¯•ç­¾åå’Œå…¬è¯æµç¨‹

---

## ğŸ“ æ›´æ–°æ—¥å¿—

**2025-12-04**
- âœ… å®Œæˆ Stats æ‰“åŒ…æ–¹æ¡ˆçš„å®Œæ•´è¿ç§»
- âœ… åˆ›å»ºæ–°çš„èƒŒæ™¯å›¾ (1000x600 @144 DPI)
- âœ… æ›´æ–° create_dmg.sh é‡‡ç”¨ Stats å‚æ•°
- âœ… åˆ›å»º Makefile è‡ªåŠ¨åŒ–æ„å»ºæµç¨‹
- âœ… ç¼–å†™å®Œæ•´çš„è¿ç§»æ–‡æ¡£

---

## ğŸ“§ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®,è¯·åœ¨é¡¹ç›®ä¸­æäº¤ Issueã€‚

---

**æ„å»ºå¿«ä¹! ğŸ‰**
